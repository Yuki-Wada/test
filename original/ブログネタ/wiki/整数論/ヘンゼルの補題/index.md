---
title: 'ヘンゼルの補題'
description: 'ヘンゼルの補題'
date: '2025-01-19'
categories: []
weight: 999
math: true
draft: true
---

## 説明

数学におけるヘンゼルの補題 1 変数多項式が素数 p を法として単根を持つならば、その根は p の任意の冪乗を法とする根に一意的に持ち上げられるという、合同算術における補題である。この補題は、多項式が法 p で2つの互いに素な多項式（英語版）に因数分解できるならば、その因数分解は p の任意の冪乗を法とする因数分解に持ち上げることができるという補題に一般化できる。因数分解に現れる多項式の次数が1の場合が根の場合に相当する。ヘンゼルの持ち上げ補題（英: Hensel's lifting lemma）とも呼ばれる。名称はクルト・ヘンゼルに因む。

\\( p \\)

多項式 \\( f \\) を有限体で考えたときに解をもつならば、\\( f \\) は \\( p \\) 進数体で考えたときに解を持つ。それならば、有限体は 1 を足し続けると 0 になってしまう、標数が正の体であるが、 \\( p \\) 進数体は標数 0 の体であり、幾分取り扱いやすいという利点がある。

解析は単純である。

解析的整数論の一分野である p 進解析学の基礎である。



## Hensel の補題の基本形

**Theorem**

\\( R \\) を完備な局所環、\\( f \in R [t] \\) を \\( R \\) 上の多項式、\\( p \in R \\) を素元とする。さらに、\\( f (x) \equiv 0 \\,\\, (\text{mod} \\,\\, p^{n}) \\) かつ \\( f' (x) \not\equiv 0 \\,\\, (\text{mod} \\,\\, p) \\) を満たす \\( x \in R \\) が存在するとする。
このとき、\\( y \equiv x \\,\\, (\text{mod} \\,\\, p^{n}) \\) かつ \\( f(y) \equiv 0 \\,\\, (\text{mod} \\,\\, p^{2n}) \\) を満たす \\( y \in R \\) が存在する。

*Proof*: 確率モデルが指数型分布族であるため、





## 現代的によく使われる Hensel の補題の主張

**Theorem**（Hensel の補題）

\\( R \\) を局所環、\\( f \in R [t] \\) を \\( R \\) 上の多項式、\\( p \in R \\) を素元とする。さらに、\\( f (x) \equiv 0 \\,\\, (\text{mod} \\,\\, p^{n}) \\) かつ \\( f' (x) \not\equiv 0 \\,\\, (\text{mod} \\,\\, p) \\) を満たす \\( x \in R \\) が存在するとする。
このとき、\\( y \equiv x \\,\\, (\text{mod} \\,\\, p^{n}) \\) かつ \\( f(y) \equiv 0 \\,\\, (\text{mod} \\,\\, p^{2n}) \\) を満たす \\( y \in R \\) が存在する。



## 説明



上記が最も強い形の Hensel の補題であるが、これだけでは何を意味しているかがよくわからない。

\\( R \\) を完備な局所環とする



**Theorem**（Hensel の補題）

\\( R \\) を完備な局所環、\\( f \in R [t] \\) を \\( R \\) 上の多項式、\\( p \in R \\) を素元とする。さらに、\\( f (x) \equiv 0 \\,\\, (\text{mod} \\,\\, p^{n}) \\) かつ \\( f' (x) \not\equiv 0 \\,\\, (\text{mod} \\,\\, p) \\) を満たす \\( x \in R \\) が存在するとする。
このとき、\\( y \equiv x \\,\\, (\text{mod} \\,\\, p^{n}) \\) かつ \\( f(y) \equiv 0 \\,\\, (\text{mod} \\,\\, p^{2n}) \\) を満たす \\( y \in R \\) が存在する。



Hensel の補題の書き方としては、\\( f(a) \equiv 0 \\,\\, (\text{mod} \\,\\, m) \\) と書かれている場合も多い。

これは \\( f(x) \equiv g(x) (x - a) \\,\\, (\text{mod} \\,\\, m) \\)



## ニュートン法による誤差評価

ヘンゼルの補題の基本形ではニュートン法を用いた。ニュートン法による誤差評価を調べる。



**Theorem**

\\( R \\) を単項イデアル整域、\\( f \in R [x] \\) を \\( R \\) 上の多項式、\\( p \in R \\) を素元とする。さらに、\\( f (a) \equiv 0 \\,\\, (\text{mod} \\,\\, p^{n}) \\) かつ \\( f' (a) \not\equiv 0 \\,\\, (\text{mod} \\,\\, p) \\) を満たす \\( a \in R \\) が存在するとする。
このとき、\\( \displaystyle b \equiv a - \frac {f(a)} {f'(a)} \\) とおくと、\\( b \equiv a \\,\\, (\text{mod} \\,\\, p^{n}) \\) かつ \\( f(b) \equiv 0 \\,\\, (\text{mod} \\,\\, p^{2n}) \\) を満たす。

*Proof*: \\( \displaystyle f (x) := \sum _ {i = 0}^{n} c _ {i} x^{i}\, \\,\\, \pi := \frac {f(a)} {f'(a)} \\) とおく。\\( \pi \equiv 0 \\,\\, (\text{mod} \\,\\, p^{n}) \\) であるため、\\( b = a - \pi \equiv a \\,\\, (\text{mod} \\,\\, p^{n})\, \pi^{2} \equiv 0 \\,\\, (\text{mod} \\,\\, p^{2n}) \\) であることがわかる。このとき、
\\[ \\begin{align} f (b) = & \\sum _ {i = 0}^{n} c _ {i} (a - \\pi )^{i} \\\\ = & \\sum _ {i = 0}^{n} (c _ {i} a^{i} - i a^{i - 1} \\pi + i (i - 1) a^{i-2} \\pi^{2} + \\cdots ) \\\\ \\equiv & \\sum _ {i = 0}^{n} (c _ {i} a^{i} - i a^{i - 1} \\pi ) \\\,\\\, (\\text{mod} \\\,\\\, p^{2n}) \\\\ = & f (a) - \\pi f'(a) \\\\ = & 0 \\end{align} \\]
であるから、\\( f (b) \equiv 0 \\,\\, (\text{mod} \\,\\, p^{2n}) \\) となることが示せた。\\( \Box \\)

通常の \\( \mathbb{R} \\) におけるNewton法は二次収束する。このHenselの持ち上げも \\( \mathbb{Z} _ {p} \\) 上で二次収束する反復アルゴリズムになっている。



## 競技プログラミングのテクニックへの拡張

競技プログラミングでは形式的べき級数を用いるテクニックが必要となる出題が最近増えてきている。上記の漸化式は競技プログラミングで使われるテクニックの基礎となっている。



**Theorem**（形式的べき級数への拡張）

\\( R \\) を完備離散付値環、\\( f \in R [[t]] \\) を \\( R \\) 上の形式的べき級数、\\( p \in R \\) を素元とする。さらに、\\( f (x)\, f' (x) \\) が定義でき、\\( f (x) \equiv 0 \\,\\, (\text{mod} \\,\\, p^{n}) \\) かつ \\( f' (x) \not\equiv 0 \\,\\, (\text{mod} \\,\\, p) \\) を満たす \\( x \in R \\) が存在するとする。
このとき、\\( f (y)\, f' (y) \\) が定義でき、\\( y \equiv x \\,\\, (\text{mod} \\,\\, p^{n}) \\) かつ \\( f(y) \equiv 0 \\,\\, (\text{mod} \\,\\, p^{2n}) \\) を満たす \\( y \in R \\) が存在する。



**Corollary**（射影極限列の存在）

\\( R \\) を完備離散付値環、\\( f \in R [[t]] \\) を \\( R \\) 上の多項式、\\( p \in R \\) を素元とする。さらに、\\( f (x _ {0})\, f' (x _ {0}) \\) が定義でき、\\( f (x _ {0}) \equiv 0 \\,\\, (\text{mod} \\,\\, p) \\) かつ \\( f' (x _ {0}) \not\equiv 0 \\,\\, (\text{mod} \\,\\, p) \\) を満たす \\( x \in R \\) が存在するとする。

このとき、ある \\( x \in R \\) に収束する \\( R \\) の数列 \\( (x _ {n}) \\) で、以下を満たすものが存在する。 
\\[ \\begin{aligned}  x \\equiv x _ {n} \\\,\\\, (\\text{mod} \\\,\\\, p^{2^{n}})\, \\\,\\\, f (x) = 0  \\end{aligned} \\]



